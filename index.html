<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EduClass SMP Xaverius</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  color:white;
}

.page{display:none;padding:20px}

button{
  padding:10px;
  border:none;
  border-radius:8px;
  background:#00c853;
  color:white;
  cursor:pointer;
  margin-top:5px;
}

input,select{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:6px;
  border:none;
}

.card{
  background:white;
  color:black;
  padding:15px;
  border-radius:10px;
  margin:10px 0;
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
</style>
</head>

<body>

<!-- LANDING -->
<div id="landing" class="page" style="display:block;text-align:center;padding-top:100px">
  <h1>ğŸ“š EduClass SMP Xaverius</h1>
  <button onclick="show('login')">Masuk</button>
</div>

<!-- LOGIN -->
<div id="login" class="page">

  <h2>Login</h2>

  <input id="name" placeholder="Nama">

  <select id="role">
    <option value="student">Siswa</option>
    <option value="teacher">Guru</option>
    <option value="kepsek">Kepala Sekolah</option>
  </select>

  <input type="password" id="password" placeholder="Sandi">

  <button onclick="login()">Masuk</button>

</div>


<!-- GURU -->
<div id="teacher" class="page">

  <div class="header">
    <h2>Dashboard Guru</h2>
    <button onclick="logout()">Keluar</button>
  </div>

  <h3>Buat Kelas</h3>
  <input id="className" placeholder="Nama Kelas">
  <button onclick="createClass()">Buat</button>

  <div id="teacherClasses"></div>

</div>


<!-- SISWA -->
<div id="student" class="page">

  <div class="header">
    <h2>Kelas Saya</h2>
    <button onclick="logout()">Keluar</button>
  </div>

  <h3>Masukkan Kode Kelas</h3>
  <input id="joinCode" placeholder="Kode kelas">
  <button onclick="joinClass()">Gabung</button>

  <div id="studentClasses"></div>

</div>


<!-- KEPALA SEKOLAH -->
<div id="kepsek" class="page">

  <div class="header">
    <h2>Dashboard Kepala Sekolah</h2>
    <button onclick="logout()">Keluar</button>
  </div>

  <h3>Aktivitas Guru</h3>
  <div id="activityLog"></div>

</div>


<script>

const PASS_GURU = "SmpXaverius1GuruHebat";
const PASS_KEPSEK = "SmpXaverius1KepalaHebat";

let currentUser=null;

/* NAV */
function show(id){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
  document.getElementById(id).style.display="block";
}

/* STORAGE */
function getData(k){ return JSON.parse(localStorage.getItem(k)) || [] }
function setData(k,v){ localStorage.setItem(k,JSON.stringify(v)) }

/* LOG AKTIVITAS */
function logActivity(text){

  let logs = getData("logs");

  logs.push({
    text,
    time:new Date().toLocaleString()
  });

  setData("logs",logs);
}

/* LOGIN */
function login(){

  const name=document.getElementById("name").value;
  const role=document.getElementById("role").value;
  const pass=document.getElementById("password").value;

  if(!name) return alert("Isi nama");

  if(role==="teacher"){
    if(pass!==PASS_GURU) return alert("Sandi guru salah");
    currentUser={name,role};
    show("teacher");
    loadTeacher();
  }

  else if(role==="kepsek"){
    if(pass!==PASS_KEPSEK) return alert("Sandi kepala sekolah salah");
    currentUser={name,role};
    show("kepsek");
    loadKepsek();
  }

  else{
    currentUser={name,role};
    show("student");
    loadStudent();
  }
}

/* LOGOUT */
function logout(){ show("landing") }

/* CREATE CLASS */
function createClass(){

  let classes=getData("classes");

  let code="CLS"+Math.floor(Math.random()*10000);

  classes.push({
    name:document.getElementById("className").value,
    code,
    teacher:currentUser.name,
    students:[],
    items:[]
  });

  setData("classes",classes);

  logActivity("Guru "+currentUser.name+" membuat kelas");

  loadTeacher();
}

/* ADD ITEM (TUGAS / ULANGAN) */
function addItem(index,type){

  let classes=getData("classes");

  let my=classes.filter(c=>c.teacher===currentUser.name);

  let cls=my[index];

  let title=document.getElementById(type+index).value;

  cls.items.push({
    title,
    type,
    submissions:[]
  });

  setData("classes",classes);

  logActivity("Guru "+currentUser.name+" menambahkan "+type+" : "+title);

  loadTeacher();
}

/* LOAD TEACHER */
function loadTeacher(){

  let classes=getData("classes");

  let my=classes.filter(c=>c.teacher===currentUser.name);

  let div=document.getElementById("teacherClasses");
  div.innerHTML="";

  my.forEach((c,i)=>{

    div.innerHTML+=`
    <div class="card">
      <h3>${c.name}</h3>
      <p>Kode: <b>${c.code}</b></p>

      <input id="tugas${i}" placeholder="Judul Tugas">
      <button onclick="addItem(${i},'tugas')">Tambah Tugas</button>

      <input id="ulangan${i}" placeholder="Judul Ulangan">
      <button onclick="addItem(${i},'ulangan')">Tambah Ulangan</button>

      <h4>Siswa</h4>
      ${c.students.map(s=>`<div>ğŸ‘¤ ${s}</div>`).join("")}

    </div>
    `;
  });
}

/* JOIN */
function joinClass(){

  let code=document.getElementById("joinCode").value;

  let classes=getData("classes");

  let cls=classes.find(c=>c.code===code);

  if(!cls) return alert("Kode tidak ada");

  if(!cls.students.includes(currentUser.name)){
    cls.students.push(currentUser.name);
  }

  setData("classes",classes);

  logActivity("Siswa "+currentUser.name+" bergabung ke kelas "+cls.name);

  loadStudent();
}

/* LOAD STUDENT */
function loadStudent(){

  let classes=getData("classes");

  let my=classes.filter(c=>c.students.includes(currentUser.name));

  let div=document.getElementById("studentClasses");

  div.innerHTML="";

  my.forEach(c=>{

    div.innerHTML+=`
    <div class="card">
      <h3>${c.name}</h3>
      <p>Guru: ${c.teacher}</p>

      ${c.items.map(it=>`
        <div>
          ${it.type==="tugas"?"ğŸ“š":"ğŸ“"} ${it.title}
          <button>Kumpulkan</button>
        </div>
      `).join("")}

    </div>
    `;
  });
}

/* LOAD KEPSEK */
function loadKepsek(){

  let logs=getData("logs");

  let div=document.getElementById("activityLog");

  div.innerHTML="";

  logs.slice().reverse().forEach(l=>{
    div.innerHTML+=`
      <div class="card">
        ${l.text}
        <br>
        <small>${l.time}</small>
      </div>
    `;
  });
}

</script>

</body>
</html>
